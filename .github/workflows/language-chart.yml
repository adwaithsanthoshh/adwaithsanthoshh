name: Update Language Chart on: schedule: - cron: "0 0 * * *" # Runs daily (UTC) workflow_dispatch: jobs: build: runs-on: ubuntu-latest steps: - name: Checkout repo uses: actions/checkout@v4 - name: Generate chart run: | curl -s https://api.github.com/users/adwaithsanthoshh/reposÂ > repos.json python3 << 'EOF' import json import requests with open("repos.json") as f: repos = json.load(f) langs = {} for repo in repos: if not repo["fork"]: data = requests.get(repo["languages_url"]).json() for k, v in data.items(): langs[k] = langs.get(k, 0) + v total = sum(langs.values()) percent = {k: round(v * 100 / total, 2) for k, v in langs.items()} labels = list(percent.keys()) values = list(percent.values()) chart_url = "https://quickchart.io/chart" payload = { "width": 500, "height": 300, "format": "png", "chart": { "type": "pie", "data": { "labels": labels, "datasets": [{"data": values}] } } } img = requests.post(chart_url, json=payload).content with open("language_chart.png", "wb") as f: f.write(img) EOF - name: Commit chart run: | git config --global user.name "github-actions" git config --global user.email "actions@github.com" git add language_chart.png git commit -m "Update language chart" || exit 0 git push
